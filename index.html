<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice IA - Glisser-Déposer</title>
    <style>
        /* Votre CSS reste inchangé */
    </style>
</head>
<body>
    <div class="container">
        <!-- Votre HTML reste inchangé -->
    </div>
    <button onclick="resetExercise()">Réinitialiser</button>
    <button onclick="checkAnswers()">Valider</button>
    <p id="resultat"></p>

    <script>
        function allowDrop(ev) {
            ev.preventDefault();
            ev.target.classList.add('active');
        }

        function dragLeave(ev) {
            ev.target.classList.remove('active');
        }

        function drag(ev) {
            ev.target.classList.add('dragging');
            ev.dataTransfer.setData("text/plain", ev.target.id);
            ev.dataTransfer.setData("text/html", ev.target.outerHTML);
        }

        function dragEnd(ev) {
            ev.target.classList.remove('dragging');
            document.querySelectorAll('.dropzone').forEach(zone => {
                zone.classList.remove('active');
            });
        }

        function drop(ev) {
            ev.preventDefault();
            ev.target.classList.remove('active');
            
            if (ev.target.children.length > 0) {
                let existingLabel = ev.target.children[0];
                let newLabel = document.createElement('div');
                newLabel.className = 'label';
                newLabel.draggable = true;
                newLabel.id = existingLabel.id;
                newLabel.innerHTML = existingLabel.innerHTML;
                newLabel.setAttribute('ondragstart', 'drag(event)');
                newLabel.setAttribute('ondragend', 'dragEnd(event)');
                document.querySelector('.label-container').appendChild(newLabel);
            }

            let id = ev.dataTransfer.getData("text/plain");
            let html = ev.dataTransfer.getData("text/html");
            
            let tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            let newElement = tempDiv.firstChild;
            
            ev.target.innerHTML = '';
            ev.target.appendChild(newElement);
            
            let originalElement = document.getElementById(id);
            if (originalElement && originalElement.parentNode.classList.contains('label-container')) {
                originalElement.remove();
            }

            // Ajouter un événement de clic pour retirer l'étiquette
            newElement.addEventListener('click', function() {
                removeLabel(newElement, ev.target);
            });
        }

        function removeLabel(label, dropzone) {
            let newLabel = document.createElement('div');
            newLabel.className = 'label';
            newLabel.draggable = true;
            newLabel.id = label.id;
            newLabel.innerHTML = label.innerHTML;
            newLabel.setAttribute('ondragstart', 'drag(event)');
            newLabel.setAttribute('ondragend', 'dragEnd(event)');
            document.querySelector('.label-container').appendChild(newLabel);
            dropzone.innerHTML = '';
            dropzone.classList.remove('incorrect', 'correct');
        }

        function checkAnswers() {
            let score = 0;
            let total = 0;
            const dropzones = document.querySelectorAll('.dropzone');
            
            dropzones.forEach(zone => {
                total++;
                if (zone.children.length > 0) {
                    const answer = zone.children[0].textContent;
                    if (answer === zone.dataset.answer) {
                        score++;
                        zone.classList.remove('incorrect');
                        zone.classList.add('correct');
                    } else {
                        zone.classList.add('incorrect');
                        zone.classList.remove('correct');
                    }
                } else {
                    zone.classList.add('incorrect');
                }
            });

            const studentName = document.getElementById('studentName').value;
            const resultat = document.getElementById('resultat');
            resultat.textContent = `${studentName} : ${score}/${total} réponses correctes`;
        }

        function resetExercise() {
            document.querySelectorAll('.dropzone').forEach(zone => {
                zone.innerHTML = '';
                zone.classList.remove('incorrect', 'correct', 'active');
            });

            const labelContainer = document.querySelector('.label-container');
            labelContainer.innerHTML = `
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Symbolique">Symbolique</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Comportementale">Comportementale</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Statistique">Statistique</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Générative">Générative</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Apprentissage supervisé">Apprentissage supervisé</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Non supervisé">Non supervisé</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Apprentissage par renforcement">Apprentissage par renforcement</div>
                <div class="label" draggable="true" ondragstart="drag(event)" ondragend="dragEnd(event)" id="Basé sur des règles fixes">Basé sur des règles fixes</div>
            `;

            document.getElementById('resultat').textContent = '';
        }
    </script>
</body>
</html>
